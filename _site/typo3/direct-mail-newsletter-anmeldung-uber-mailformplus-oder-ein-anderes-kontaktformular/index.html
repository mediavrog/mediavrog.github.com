<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular &#8211; mediavrog</title>
<meta name="description" content="
  Die Anmeldung zum Erhalt eines Newsletters per DirectMail läuft bekannterweise über die Extension [Direct Mail Subscription][1].


">
<meta name="keywords" content="direct-mail, mailformplus, newsletter, typo3, userFunc">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular">
<meta name="twitter:description" content="
  Die Anmeldung zum Erhalt eines Newsletters per DirectMail läuft bekannterweise über die Extension [Direct Mail Subscription][1].


">
<meta name="twitter:site" content="@mediavrog">
<meta name="twitter:creator" content="@mediavrog">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://127.0.0.1:4000/images/typo33.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular">
<meta property="og:description" content="
  Die Anmeldung zum Erhalt eines Newsletters per DirectMail läuft bekannterweise über die Extension [Direct Mail Subscription][1].


">
<meta property="og:url" content="http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/">
<meta property="og:site_name" content="mediavrog">

<meta property="og:image" content="http://127.0.0.1:4000/images/typo33.jpg">






<link rel="canonical" href="http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/">
<link href="http://127.0.0.1:4000/feed.xml" type="application/atom+xml" rel="alternate" title="mediavrog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://127.0.0.1:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://127.0.0.1:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://127.0.0.1:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://127.0.0.1:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400,300" />

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://127.0.0.1:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://127.0.0.1:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://127.0.0.1:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://127.0.0.1:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://127.0.0.1:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://127.0.0.1:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://127.0.0.1:4000/">mediavrog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="http://127.0.0.1:4000/about/" >About</a></li>
				
				    
				    <li><a href="http://127.0.0.1:4000/blog/" >Blog</a></li>
				
				    
				    <li><a href="http://127.0.0.1:4000/projects/" >Projects</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->




<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="http://127.0.0.1:4000/images/bio-photo.png" class="bio-photo" alt="Maik Vlcek bio photo">


  <h4 itemprop="name">Maik Vlcek</h4>
  <p><small>Full stack & mobile engineer</small></p>
  
  
  <a href="http://twitter.com/mediavrog" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  
  
  
  
  
  <a href="http://github.com/mediavrog" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/" rel="bookmark" title="Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular">Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <blockquote>
  <p>Die Anmeldung zum Erhalt eines Newsletters per DirectMail läuft bekannterweise über die Extension <a href="http://typo3.org/extensions/repository/view/direct_mail_subscription/1.1.0/" title="Seite der Extension auf Typo3.org besuchen (öffnet neues Fenster)">Direct Mail Subscription</a>.</p>
</blockquote>

<p>Doch leider fehlt es ihr an Flexibilität, da die Funktionalität des Anmeldens (inkl. Versand einer Bestätigungsmail) nicht in einer Methode gekapselt ist, sondern über Typoscript realisiert wird (userFunc). Somit ist es nicht ohne Weiteres möglich, eine Newsletteranmeldung per Checkbox in einem beliebigen (Kontakt-)Formular zu integrieren. Im Folgenden wird eine Lösung gezeigt, welche die beschriebene Funktionalität ermöglicht.</p>

<p>Das TS-Setup findet sich in der ext_typoscript_setup.txt von <a href="http://typo3.org/extensions/repository/view/direct_mail_subscription/1.1.0/" title="Seite der Extension auf Typo3.org besuchen (öffnet neues Fenster)">Direct Mail Subscription</a> (ein Auszug):</p>

<p>plugin.feadmin.dmailsubscription &gt;</p>

<p>plugin.feadmin.dmailsubscription = USER_INT</p>

<p>plugin.feadmin.dmailsubscription {</p>

<p>userFunc = user_feAdmin-&gt;init</p>

<p>includeLibs = media/scripts/fe_adminLib.inc</p>

<p>templateFile = {$plugin.feadmin.dmailsubscription.file.templateFile}</p>

<p>[…]</p>

<p>Nach dem Einschreiben über das Frontendplugin von <a href="http://typo3.org/extensions/repository/view/direct_mail_subscription/1.1.0/" title="Seite der Extension auf Typo3.org besuchen (öffnet neues Fenster)">Direct Mail Subscription</a> werden die Daten an die init-Methode der Klasse user_feAdminübergeben, welche sich um das Speichern der Daten in der richtigen Tabelle und den Versand einer Bestätigungsmail (Double Opt-In) kümmert.</p>

<p>Um diese Funktionalität in der eigenen Extension oder einer userFunktion (z.B. bei <a href="http://typo3.org/documentation/document-library/extension-manuals/th_mailformplus/4.0.5/view/1/5/#id3823153" title="Dokumentation der saveUserFunc auf Typo3.org in neuem Fenster öffnen">Mailformplus die saveUserFunc</a>) nutzen zu können muss man wie im TS die richtigen Bibliotheken einbinden und noch ein paar Parameter setzen. Es folgt eine Schritt für Schritt-Anleitung. Es wird vorausgesetzt, dass bereits eine PHP-Datei exisitiert, welche nach dem Abschicken des Mailformulars ausgeführt wird (ähnlich der <a href="http://typo3.org/documentation/document-library/extension-manuals/th_mailformplus/4.0.5/view/1/5/#id3823153">saveUserFunc von Mailformplus</a> ) und die Extension <a href="http://typo3.org/extensions/repository/view/direct_mail_subscription/1.1.0/">Direct Mail Subscription</a> passend konfiguriert ist.</p>

<h2 id="die-bentigten-klassen-und-bibliotheken-einbinden">die benötigten Klassen und Bibliotheken einbinden</h2>

<p>// fe_admin Bibliothek; speichert Daten in DB und verschickt die Bestätigungsmail
require_once(“typo3/sysext/cms/tslib/media/scripts/fe_adminLib.inc”);</p>

<p>// Extension Direct Mail Subscription; enthält Konfiguration; wird eventuell nicht gebraucht(?)
require_once(t3lib_extMgm::extPath(‘direct_mail_subscription’).’pi/class.dmailsubscribe.php’);</p>

<h2 id="die-konfiguration-von-direct-mail-subscription-holen">Die Konfiguration von Direct Mail Subscription holen</h2>

<p>$conf = $GLOBALS[‘TSFE’]-&gt;tmpl-&gt;setup[‘plugin.’][‘feadmin.’][‘dmailsubscription.’];</p>

<p>In dieser Konfiguration ist unter Anderem der Pfad zum Template der Anmeldung kodiert, welche von feAdmin benötigt wird. Falls das Template nicht gefunden wird, so kann man den Pfad auch korrigieren:</p>

<p>$conf[‘templateFile’] = “../../../”.$conf[‘templateFile’];</p>

<h2 id="die-richtigen-post-variablen-nutzen">Die richtigen Post-Variablen nutzen</h2>

<p>Die init Methode der fe_admin wird sich $_POST[‚FE‘] Daten holen, um mit diesen zu arbeiten. Dabei ist in zweiter Ebene des Arrays die Tabelle codiert, in der die Daten gespeichert werden. Der Schlüssel dritter Ebene repräsentiert nunmehr das DB Feld. Folgende Post-Variablen sollten beim Abschicken des Formulars mitgeschickt werden, ansonsten können sie auch in PHP mit eigenen Werten belegt werden.</p>

<p>// Name des Newsletterempfängers
$_POST[‘FE’][‘tt_address’][‘name’];</p>

<p>// Emailadresse
$_POST[‘FE’][‘tt_address’][‘email’];</p>

<p>// Sollen HTML Mails empfangen werden?
$_POST[‘FE’][‘tt_address’][‘module_sys_dmail_html’];</p>

<h2 id="objekt-von-userfeadmin-erzeugen-und-konfiguration-bergeben">Objekt von user_feAdmin erzeugen und Konfiguration übergeben</h2>

<p>$ua = new user_feAdmin();</p>

<p>$ua-&gt;cObj = t3lib_div::makeInstance(‘tslib_cObj’);</p>

<p>$ua-&gt;init($content,$conf);</p>

<p>Die Variable $content kann laut <a href="http://doc-typo3.ameos.com/4.1.0/classuser__feAdmin.html" title="Class Reference von feAdmin  öffnen">Class Reference von feAdmin</a> weggelassen werden (leerer String).</p>

<p>Mit dem Ausführen der init-Methode werden alle nötigen Prozesse angestoßen, welche zur Newsletteranmeldung benötigt werden.</p>

<h3 id="beispiel">Beispiel</h3>

<p>Hier nochmal ein Codeblock mit allen benötigten Schritten: <a href="http://mediavrog.net/blog/wp-content/uploads/2008/03/example_newslettersub.txt" title="Beispiel">Beispiel</a></p>

<h3 id="kommentare">Kommentare?</h3>

<p><strong>Falls jemand eine einfachere Implementation kennt oder sonstige Hinweise zu meinem Vorschlag hat, der poste doch bitte einen Kommentar :)</strong></p>

<h3 id="hinweise">Hinweise</h3>

<p><em>Noch zwei letzte Hinweise, falls keine Bestätigungsmail verschickt wird:</em></p>

<p>Es kann u.A. daran liegen, dass das Template für <a href="http://typo3.org/extensions/repository/view/direct_mail_subscription/1.1.0/">Direct Mail Subscription</a> nicht gefunden wird. Der Rückgabewert der init-Methode gibt meistens einen guten Aufschluss über den Status und eventuelle Fehler. Einfach mal in ner Variable ablegen und ausgeben (per echo, var_dump etc).</p>

<p>Per getcwd() kann man außerdem per PHP prüfen, in welchen Verzeichnis das aktuelle Script ausgeführt wird. Hilft beim Testen ob der Pfad zum Template File stimmt.</p>


      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://127.0.0.1:4000/typo3/direct-mail-newsletter-anmeldung-uber-mailformplus-oder-ein-anderes-kontaktformular/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Direct Mail Newsletter Anmeldung über Mailformplus oder ein anderes Kontaktformular</strong> was published on <time datetime="2008-03-25T12:03:00+09:00">March 25, 2008</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->


  
  <aside class="read-next">
    <a class="read-next-story prev " style="" href="http://127.0.0.1:4000/formatting-post/" title="Formatting Post">
      <section class="post">
        <h2>Formatting Post</h2>
        Demo post displaying the various ways of highlighting code in Markdown.
      </section>
    </a>
  </aside>
  


<div class="footer-wrap">
  <footer>
    

<section class="copyright"><a href="http://127.0.0.1:4000">Maik Vlcek</a> &copy; 2016</section>
<section class="poweredby">Proudly published with <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a></section>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://127.0.0.1:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://127.0.0.1:4000/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-1304393-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  



</body>
</html>
